[0m22:31:30.721635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181a0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a523830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a86c9e0>]}


============================== 22:31:30.722976 | 24a0c643-42fe-4e48-8961-5c2e92e414a1 ==============================
[0m22:31:30.722976 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:31:30.723206 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/nairuiliu/build_lab2/logs', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/nairuiliu/.dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'version_check': 'True'}
[0m22:31:31.537156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f58d7c0>]}
[0m22:31:31.552671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b3e870>]}
[0m22:31:31.553084 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:31:31.562447 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:31:31.562821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:31:31.562959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5ebe60>]}
[0m22:31:31.869244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_lab2.output
[0m22:31:31.872597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc15670>]}
[0m22:31:31.930807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc5a060>]}
[0m22:31:31.931016 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m22:31:31.931133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc14050>]}
[0m22:31:31.931716 [info ] [MainThread]: 
[0m22:31:31.931923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:31:31.932290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:31:31.936631 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:31:31.936741 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:31:31.936822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:32.982849 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.046 seconds
[0m22:31:32.985420 [debug] [ThreadPool]: On list_dev: Close
[0m22:31:33.106792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:31:33.117668 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:31:33.118060 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:31:33.118317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:33.651608 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.533 seconds
[0m22:31:33.656522 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:31:33.797714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c362a0>]}
[0m22:31:33.798429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:31:33.798746 [info ] [MainThread]: 
[0m22:31:33.802200 [debug] [Thread-1 (]: Began running node model.build_lab2.90dprice_all_symbols
[0m22:31:33.802790 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.90dprice_all_symbols ..................... [RUN]
[0m22:31:33.803228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_lab2.90dprice_all_symbols)
[0m22:31:33.803528 [debug] [Thread-1 (]: Began compiling node model.build_lab2.90dprice_all_symbols
[0m22:31:33.810069 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_lab2.90dprice_all_symbols"
[0m22:31:33.810863 [debug] [Thread-1 (]: Began executing node model.build_lab2.90dprice_all_symbols
[0m22:31:33.828387 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_lab2.90dprice_all_symbols"
[0m22:31:33.828976 [debug] [Thread-1 (]: Using snowflake connection "model.build_lab2.90dprice_all_symbols"
[0m22:31:33.829140 [debug] [Thread-1 (]: On model.build_lab2.90dprice_all_symbols: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "model.build_lab2.90dprice_all_symbols"} */
create or replace   view dev.analytics.90dprice_all_symbols
  
   as (
    SELECT *
FROM dev.raw_data.time_series_daily
WHERE close IS NOT NULL
  );
[0m22:31:33.829284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:34.488437 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85687-0004-2d6b-0001-86f30007a57e
[0m22:31:34.489108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 38 unexpected '.90'.
[0m22:31:34.489635 [debug] [Thread-1 (]: On model.build_lab2.90dprice_all_symbols: Close
[0m22:31:34.630439 [debug] [Thread-1 (]: Database Error in model 90dprice_all_symbols (models/input/90dprice_all_symbols.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 38 unexpected '.90'.
  compiled code at target/run/build_lab2/models/input/90dprice_all_symbols.sql
[0m22:31:34.632588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a0c643-42fe-4e48-8961-5c2e92e414a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a86e240>]}
[0m22:31:34.633422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.90dprice_all_symbols ............ [[31mERROR[0m in 0.83s]
[0m22:31:34.634061 [debug] [Thread-1 (]: Finished running node model.build_lab2.90dprice_all_symbols
[0m22:31:34.636224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:34.636553 [debug] [MainThread]: Connection 'model.build_lab2.90dprice_all_symbols' was properly closed.
[0m22:31:34.636800 [info ] [MainThread]: 
[0m22:31:34.637066 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m22:31:34.637681 [debug] [MainThread]: Command end result
[0m22:31:34.659966 [info ] [MainThread]: 
[0m22:31:34.660274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:31:34.660438 [info ] [MainThread]: 
[0m22:31:34.660645 [error] [MainThread]:   Database Error in model 90dprice_all_symbols (models/input/90dprice_all_symbols.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 38 unexpected '.90'.
  compiled code at target/run/build_lab2/models/input/90dprice_all_symbols.sql
[0m22:31:34.660798 [info ] [MainThread]: 
[0m22:31:34.660972 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:31:34.663639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9741974, "process_user_time": 3.682447, "process_kernel_time": 0.402494, "process_mem_max_rss": "205684736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:31:34.663949 [debug] [MainThread]: Command `dbt run` failed at 22:31:34.663898 after 3.97 seconds
[0m22:31:34.664169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fd3cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bdbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f244c80>]}
[0m22:31:34.664343 [debug] [MainThread]: Flushing usage events
[0m22:37:49.405937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cce0>]}


============================== 22:37:49.407741 | 744b4058-3479-4bb0-89bc-b75e5008e5af ==============================
[0m22:37:49.407741 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:37:49.407974 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'log_path': '/Users/nairuiliu/build_lab2/logs', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'profiles_dir': '/Users/nairuiliu/.dbt'}
[0m22:37:50.187094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fea2510>]}
[0m22:37:50.202805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128325940>]}
[0m22:37:50.203183 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:37:50.211753 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:37:50.260418 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:37:50.260643 [debug] [MainThread]: Partial parsing: added file: build_lab2://models/input/price90days_all_symbols.sql
[0m22:37:50.260738 [debug] [MainThread]: Partial parsing: deleted file: build_lab2://models/input/90dprice_all_symbols.sql
[0m22:37:50.329450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_lab2.output
[0m22:37:50.333377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283be420>]}
[0m22:37:50.362533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288687d0>]}
[0m22:37:50.362706 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m22:37:50.362813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284460c0>]}
[0m22:37:50.363401 [info ] [MainThread]: 
[0m22:37:50.363606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:37:50.363922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:37:50.368402 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:37:50.368529 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:37:50.368618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:50.992856 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.624 seconds
[0m22:37:50.995911 [debug] [ThreadPool]: On list_dev: Close
[0m22:37:51.133459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:37:51.146880 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:37:51.147598 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:37:51.147975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:51.628810 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.480 seconds
[0m22:37:51.633454 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:37:51.796752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12876db20>]}
[0m22:37:51.797772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:37:51.798135 [info ] [MainThread]: 
[0m22:37:51.801834 [debug] [Thread-1 (]: Began running node model.build_lab2.price90days_all_symbols
[0m22:37:51.802568 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.price90days_all_symbols .................. [RUN]
[0m22:37:51.803048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_lab2.price90days_all_symbols)
[0m22:37:51.803403 [debug] [Thread-1 (]: Began compiling node model.build_lab2.price90days_all_symbols
[0m22:37:51.812175 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_lab2.price90days_all_symbols"
[0m22:37:51.812990 [debug] [Thread-1 (]: Began executing node model.build_lab2.price90days_all_symbols
[0m22:37:51.832724 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_lab2.price90days_all_symbols"
[0m22:37:51.833359 [debug] [Thread-1 (]: Using snowflake connection "model.build_lab2.price90days_all_symbols"
[0m22:37:51.833544 [debug] [Thread-1 (]: On model.build_lab2.price90days_all_symbols: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "model.build_lab2.price90days_all_symbols"} */
create or replace   view dev.analytics.price90days_all_symbols
  
   as (
    SELECT *
FROM dev.raw_data.time_series_daily
WHERE close IS NOT NULL
  );
[0m22:37:51.833713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:52.586868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m22:37:52.608126 [debug] [Thread-1 (]: On model.build_lab2.price90days_all_symbols: Close
[0m22:37:52.725269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '744b4058-3479-4bb0-89bc-b75e5008e5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282905f0>]}
[0m22:37:52.726453 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.price90days_all_symbols ............. [[32mSUCCESS 1[0m in 0.92s]
[0m22:37:52.727155 [debug] [Thread-1 (]: Finished running node model.build_lab2.price90days_all_symbols
[0m22:37:52.728627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:52.728942 [debug] [MainThread]: Connection 'model.build_lab2.price90days_all_symbols' was properly closed.
[0m22:37:52.729239 [info ] [MainThread]: 
[0m22:37:52.729523 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m22:37:52.730139 [debug] [MainThread]: Command end result
[0m22:37:52.752153 [info ] [MainThread]: 
[0m22:37:52.752478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:52.752659 [info ] [MainThread]: 
[0m22:37:52.752833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:37:52.755404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.373714, "process_user_time": 3.366779, "process_kernel_time": 0.449799, "process_mem_max_rss": "208027648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:37:52.755754 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:52.755700 after 3.37 seconds
[0m22:37:52.755977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dbe90>]}
[0m22:37:52.756156 [debug] [MainThread]: Flushing usage events
[0m22:58:11.675965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a370c20>]}


============================== 22:58:11.677382 | d1b8e6e6-c129-46a4-aadd-7e080c9f11d5 ==============================
[0m22:58:11.677382 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:58:11.677602 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/Users/nairuiliu/build_lab2/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'profiles_dir': '/Users/nairuiliu/.dbt', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'write_json': 'True'}
[0m22:58:12.464918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f545640>]}
[0m22:58:12.480095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9b740>]}
[0m22:58:12.480506 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:58:12.491801 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:58:12.541304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:58:12.541516 [debug] [MainThread]: Partial parsing: added file: build_lab2://models/output/stock_price_analysis.sql
[0m22:58:12.612924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368cab70>]}
[0m22:58:12.642742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084950a0>]}
[0m22:58:12.642923 [info ] [MainThread]: Found 2 models, 2 sources, 459 macros
[0m22:58:12.643052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fff0830>]}
[0m22:58:12.643660 [info ] [MainThread]: 
[0m22:58:12.643860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:58:12.645283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:58:12.649513 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:58:12.649624 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:58:12.649704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:13.170781 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.521 seconds
[0m22:58:13.173414 [debug] [ThreadPool]: On list_dev: Close
[0m22:58:13.308342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:58:13.319197 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:58:13.319553 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:58:13.319788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:13.890924 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.571 seconds
[0m22:58:13.894866 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:58:14.032838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60ad50>]}
[0m22:58:14.033719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:58:14.034091 [info ] [MainThread]: 
[0m22:58:14.037730 [debug] [Thread-1 (]: Began running node model.build_lab2.price90days_all_symbols
[0m22:58:14.038370 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.price90days_all_symbols .................. [RUN]
[0m22:58:14.038836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_lab2.price90days_all_symbols)
[0m22:58:14.039157 [debug] [Thread-1 (]: Began compiling node model.build_lab2.price90days_all_symbols
[0m22:58:14.047167 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_lab2.price90days_all_symbols"
[0m22:58:14.047957 [debug] [Thread-1 (]: Began executing node model.build_lab2.price90days_all_symbols
[0m22:58:14.067591 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_lab2.price90days_all_symbols"
[0m22:58:14.068198 [debug] [Thread-1 (]: Using snowflake connection "model.build_lab2.price90days_all_symbols"
[0m22:58:14.068392 [debug] [Thread-1 (]: On model.build_lab2.price90days_all_symbols: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "model.build_lab2.price90days_all_symbols"} */
create or replace   view dev.analytics.price90days_all_symbols
  
   as (
    SELECT *
FROM dev.raw_data.time_series_daily
WHERE close IS NOT NULL
  );
[0m22:58:14.068564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:14.748345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m22:58:14.773042 [debug] [Thread-1 (]: On model.build_lab2.price90days_all_symbols: Close
[0m22:58:14.891920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e1280>]}
[0m22:58:14.893014 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.price90days_all_symbols ............. [[32mSUCCESS 1[0m in 0.85s]
[0m22:58:14.893704 [debug] [Thread-1 (]: Finished running node model.build_lab2.price90days_all_symbols
[0m22:58:14.894734 [debug] [Thread-1 (]: Began running node model.build_lab2.stock_price_analysis
[0m22:58:14.895332 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.stock_price_analysis .................... [RUN]
[0m22:58:14.895909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_lab2.price90days_all_symbols, now model.build_lab2.stock_price_analysis)
[0m22:58:14.896331 [debug] [Thread-1 (]: Began compiling node model.build_lab2.stock_price_analysis
[0m22:58:14.900266 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_lab2.stock_price_analysis"
[0m22:58:14.901263 [debug] [Thread-1 (]: Began executing node model.build_lab2.stock_price_analysis
[0m22:58:14.919130 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_lab2.stock_price_analysis"
[0m22:58:14.921168 [debug] [Thread-1 (]: Using snowflake connection "model.build_lab2.stock_price_analysis"
[0m22:58:14.921439 [debug] [Thread-1 (]: On model.build_lab2.stock_price_analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "model.build_lab2.stock_price_analysis"} */
create or replace transient table dev.analytics.stock_price_analysis
         as
        (WITH staged_data AS (
    SELECT *
    FROM dev.analytics.price90days_all_symbols
),

-- 50-day Moving Average
moving_averages AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS ma_50
    FROM staged_data
),

-- 14-day RSI
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        COALESCE(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date), 0) AS price_change
    FROM staged_data
),
gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),
average_gain_loss AS (
    SELECT
        date,
        symbol,
        close,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),
rsi_14_calculation AS (
    SELECT
        date,
        symbol,
        close,
        ma_50,
        100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14
    FROM average_gain_loss
    JOIN moving_averages USING (date, symbol, close)
),

-- 10-day Momentum
momentum_calculation AS (
    SELECT
        date,
        symbol,
        close,
        ma_50,
        rsi_14,
        LAG(close, 10) OVER (PARTITION BY symbol ORDER BY date) AS price_10_days_ago,
        ((close - LAG(close, 10) OVER (PARTITION BY symbol ORDER BY date)) / 
        NULLIF(LAG(close, 10) OVER (PARTITION BY symbol ORDER BY date), 0)) * 100 AS momentum_10
    FROM rsi_14_calculation
)

SELECT
    date,
    symbol,
    close,
    ma_50,
    rsi_14,
    momentum_10
FROM momentum_calculation
        );
[0m22:58:14.921691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:16.481813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.560 seconds
[0m22:58:16.486602 [debug] [Thread-1 (]: On model.build_lab2.stock_price_analysis: Close
[0m22:58:16.604764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b8e6e6-c129-46a4-aadd-7e080c9f11d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c6a2d0>]}
[0m22:58:16.606293 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.stock_price_analysis ............... [[32mSUCCESS 1[0m in 1.71s]
[0m22:58:16.607312 [debug] [Thread-1 (]: Finished running node model.build_lab2.stock_price_analysis
[0m22:58:16.608695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:16.609062 [debug] [MainThread]: Connection 'model.build_lab2.stock_price_analysis' was properly closed.
[0m22:58:16.609359 [info ] [MainThread]: 
[0m22:58:16.609660 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m22:58:16.610398 [debug] [MainThread]: Command end result
[0m22:58:16.630132 [info ] [MainThread]: 
[0m22:58:16.630381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:16.630528 [info ] [MainThread]: 
[0m22:58:16.630678 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:58:16.633017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9830236, "process_user_time": 3.498925, "process_kernel_time": 0.370534, "process_mem_max_rss": "209649664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:58:16.633358 [debug] [MainThread]: Command `dbt run` succeeded at 22:58:16.633302 after 4.98 seconds
[0m22:58:16.633575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109512300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdb17f0>]}
[0m22:58:16.633746 [debug] [MainThread]: Flushing usage events
[0m23:19:37.903780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107290e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107290bf0>]}


============================== 23:19:37.905293 | 7a9e91d6-ae5c-417c-82d8-4a2d41866966 ==============================
[0m23:19:37.905293 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:19:37.905524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/Users/nairuiliu/.dbt', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'log_path': '/Users/nairuiliu/build_lab2/logs'}
[0m23:19:38.691402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a9e91d6-ae5c-417c-82d8-4a2d41866966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3267b0>]}
[0m23:19:38.706918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a9e91d6-ae5c-417c-82d8-4a2d41866966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb8b500>]}
[0m23:19:38.707356 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:19:38.716740 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:19:38.765639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:19:38.765839 [debug] [MainThread]: Partial parsing: added file: build_lab2://snapshots/snapshot_stock_price_analysis.sql
[0m23:19:38.815231 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: ['date', 'symbol'] is not valid under any of the given schemas
[0m23:19:38.817085 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.93856406, "process_user_time": 3.128124, "process_kernel_time": 0.331651, "process_mem_max_rss": "195657728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:19:38.817335 [debug] [MainThread]: Command `dbt snapshot` failed at 23:19:38.817293 after 0.94 seconds
[0m23:19:38.817480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ed96bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f00d1f0>]}
[0m23:19:38.817604 [debug] [MainThread]: Flushing usage events
[0m23:22:13.016881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095acb00>]}


============================== 23:22:13.018397 | 7e5372f8-849c-4d6b-be3f-bb7abd99f5a4 ==============================
[0m23:22:13.018397 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:22:13.018622 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/nairuiliu/.dbt', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/Users/nairuiliu/build_lab2/logs'}
[0m23:22:13.637810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a61b0>]}
[0m23:22:13.652922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a38f410>]}
[0m23:22:13.653358 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:22:13.661949 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:22:13.709197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:22:13.709410 [debug] [MainThread]: Partial parsing: added file: build_lab2://snapshots/snapshot_stock_price_analysis.sql
[0m23:22:13.792312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f491010>]}
[0m23:22:13.826095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f49c470>]}
[0m23:22:13.826266 [info ] [MainThread]: Found 2 models, 1 snapshot, 2 sources, 459 macros
[0m23:22:13.826380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a7b12b0>]}
[0m23:22:13.826985 [info ] [MainThread]: 
[0m23:22:13.827186 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:22:13.827554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:22:13.831772 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:22:13.831882 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:22:13.831964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:14.368294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m23:22:14.370309 [debug] [ThreadPool]: On list_dev: Close
[0m23:22:14.493394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m23:22:14.502334 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:22:14.502663 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:22:14.502883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:14.940967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.438 seconds
[0m23:22:14.945453 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:22:15.068359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m23:22:15.072468 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:22:15.072870 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:22:15.073150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:15.596523 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.523 seconds
[0m23:22:15.599758 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:22:15.736063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107933bf0>]}
[0m23:22:15.737045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:22:15.737402 [info ] [MainThread]: 
[0m23:22:15.741345 [debug] [Thread-1 (]: Began running node snapshot.build_lab2.snapshot_session_summary
[0m23:22:15.742000 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:22:15.742420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.build_lab2.snapshot_session_summary)
[0m23:22:15.742731 [debug] [Thread-1 (]: Began compiling node snapshot.build_lab2.snapshot_session_summary
[0m23:22:15.751540 [debug] [Thread-1 (]: Began executing node snapshot.build_lab2.snapshot_session_summary
[0m23:22:15.783255 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_lab2.snapshot_session_summary"
[0m23:22:15.783465 [debug] [Thread-1 (]: On snapshot.build_lab2.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "snapshot.build_lab2.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m23:22:15.783607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:16.206730 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.423 seconds
[0m23:22:16.248511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_lab2.snapshot_session_summary"
[0m23:22:16.248828 [debug] [Thread-1 (]: On snapshot.build_lab2.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "snapshot.build_lab2.snapshot_session_summary"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (

    with snapshot_query as (

        

SELECT * FROM dev.analytics.stock_price_analysis

    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m23:22:16.407396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b856ba-0004-2c67-0001-86f300079f06
[0m23:22:16.407713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 8
invalid identifier 'SYMBOL'
[0m23:22:16.408063 [debug] [Thread-1 (]: On snapshot.build_lab2.snapshot_session_summary: Close
[0m23:22:16.532726 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/snapshot_stock_price_analysis.sql)
  000904 (42000): SQL compilation error: error line 17 at position 8
  invalid identifier 'SYMBOL'
[0m23:22:16.534875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5372f8-849c-4d6b-be3f-bb7abd99f5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893d400>]}
[0m23:22:16.535902 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.79s]
[0m23:22:16.536523 [debug] [Thread-1 (]: Finished running node snapshot.build_lab2.snapshot_session_summary
[0m23:22:16.538663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:16.538955 [debug] [MainThread]: Connection 'snapshot.build_lab2.snapshot_session_summary' was properly closed.
[0m23:22:16.539218 [info ] [MainThread]: 
[0m23:22:16.539512 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m23:22:16.540091 [debug] [MainThread]: Command end result
[0m23:22:16.560746 [info ] [MainThread]: 
[0m23:22:16.561061 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:22:16.561221 [info ] [MainThread]: 
[0m23:22:16.561426 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/snapshot_stock_price_analysis.sql)
  000904 (42000): SQL compilation error: error line 17 at position 8
  invalid identifier 'SYMBOL'
[0m23:22:16.561571 [info ] [MainThread]: 
[0m23:22:16.561741 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:22:16.564130 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.5700562, "process_user_time": 3.519693, "process_kernel_time": 0.357779, "process_mem_max_rss": "210927616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:16.564466 [debug] [MainThread]: Command `dbt snapshot` failed at 23:22:16.564409 after 3.57 seconds
[0m23:22:16.564684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109548260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f76a0f0>]}
[0m23:22:16.564862 [debug] [MainThread]: Flushing usage events
[0m23:27:33.634209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126acf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126acce0>]}


============================== 23:27:33.635666 | 99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf ==============================
[0m23:27:33.635666 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:27:33.635913 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/nairuiliu/.dbt', 'log_path': '/Users/nairuiliu/build_lab2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'empty': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80'}
[0m23:27:34.427142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305f1d60>]}
[0m23:27:34.442573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306b38c0>]}
[0m23:27:34.443011 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:27:34.454517 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:27:34.508565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:27:34.508811 [debug] [MainThread]: Partial parsing: added file: build_lab2://models/schema.yml
[0m23:27:34.592187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521f3ec0>]}
[0m23:27:34.634759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523f6030>]}
[0m23:27:34.634949 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 test, 2 sources, 459 macros
[0m23:27:34.635076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523a4230>]}
[0m23:27:34.635703 [info ] [MainThread]: 
[0m23:27:34.635929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:34.637350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m23:27:34.642352 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:27:34.642459 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:27:34.642541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:35.129680 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.487 seconds
[0m23:27:35.134827 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:27:35.244826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m23:27:35.248602 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:27:35.248972 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:27:35.249231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:35.765685 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.516 seconds
[0m23:27:35.769766 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:27:35.883209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99973c4c-a0cd-4bb1-9a43-0b97fdf3adbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520d4050>]}
[0m23:27:35.883991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:35.884322 [info ] [MainThread]: 
[0m23:27:35.887650 [debug] [Thread-1 (]: Began running node test.build_lab2.not_null_stock_price_analysis_close.c1575213a5
[0m23:27:35.888073 [info ] [Thread-1 (]: 1 of 1 START test not_null_stock_price_analysis_close .......................... [RUN]
[0m23:27:35.888440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.build_lab2.not_null_stock_price_analysis_close.c1575213a5)
[0m23:27:35.888707 [debug] [Thread-1 (]: Began compiling node test.build_lab2.not_null_stock_price_analysis_close.c1575213a5
[0m23:27:35.901363 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_lab2.not_null_stock_price_analysis_close.c1575213a5"
[0m23:27:35.901944 [debug] [Thread-1 (]: Began executing node test.build_lab2.not_null_stock_price_analysis_close.c1575213a5
[0m23:27:35.913342 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_lab2.not_null_stock_price_analysis_close.c1575213a5"
[0m23:27:35.913852 [debug] [Thread-1 (]: Using snowflake connection "test.build_lab2.not_null_stock_price_analysis_close.c1575213a5"
[0m23:27:35.914022 [debug] [Thread-1 (]: On test.build_lab2.not_null_stock_price_analysis_close.c1575213a5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_lab2", "target_name": "dev", "node_id": "test.build_lab2.not_null_stock_price_analysis_close.c1575213a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_price_analysis
where close is null



      
    ) dbt_internal_test
[0m23:27:35.914172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:36.987623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m23:27:36.999720 [debug] [Thread-1 (]: On test.build_lab2.not_null_stock_price_analysis_close.c1575213a5: Close
[0m23:27:37.177761 [info ] [Thread-1 (]: 1 of 1 PASS not_null_stock_price_analysis_close ................................ [[32mPASS[0m in 1.29s]
[0m23:27:37.178622 [debug] [Thread-1 (]: Finished running node test.build_lab2.not_null_stock_price_analysis_close.c1575213a5
[0m23:27:37.179846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:37.180148 [debug] [MainThread]: Connection 'test.build_lab2.not_null_stock_price_analysis_close.c1575213a5' was properly closed.
[0m23:27:37.180405 [info ] [MainThread]: 
[0m23:27:37.180675 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m23:27:37.181235 [debug] [MainThread]: Command end result
[0m23:27:37.201801 [info ] [MainThread]: 
[0m23:27:37.202062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:37.202208 [info ] [MainThread]: 
[0m23:27:37.202352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:27:37.204549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5966725, "process_user_time": 3.42549, "process_kernel_time": 0.363799, "process_mem_max_rss": "210681856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:37.204826 [debug] [MainThread]: Command `dbt test` succeeded at 23:27:37.204776 after 3.60 seconds
[0m23:27:37.205006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ad010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126acfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126acf20>]}
[0m23:27:37.205164 [debug] [MainThread]: Flushing usage events
[0m23:31:21.047142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091440e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099acbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ac980>]}


============================== 23:31:21.048632 | 9a368456-1861-422b-a3ec-a35b05f70f20 ==============================
[0m23:31:21.048632 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:31:21.048864 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/nairuiliu/Repositories/sjsu-data226/week8/airflow/build_lab2/logs', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/nairuiliu/.dbt'}
[0m23:31:21.088907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a368456-1861-422b-a3ec-a35b05f70f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945bef0>]}
[0m23:31:21.098964 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.07568279, "process_user_time": 0.446355, "process_kernel_time": 0.113183, "process_mem_max_rss": "107053056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:21.099190 [debug] [MainThread]: Command `dbt clean` succeeded at 23:31:21.099152 after 0.08 seconds
[0m23:31:21.099315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a727e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109977590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099acc20>]}
[0m23:31:21.099428 [debug] [MainThread]: Flushing usage events
